# POKERTOOL-HEADER-START
# ---
# schema: pokerheader.v1
# project: pokertool
# file: pokertool/requirements_scraper.txt
# version: '20'
# last_commit: '2025-09-09T15:38:42+00:00'
# fixes: []
# ---
# POKERTOOL-HEADER-END
# Poker Assistant Screen Scraper - Installation Requirements

## Required Python Packages

Install the following packages for the screen scraping functionality:

```bash
# Core computer vision and OCR
pip install opencv-python==4.8.1.78
pip install opencv-contrib-python==4.8.1.78
pip install pytesseract==0.3.10
pip install Pillow==10.1.0

# Screen capture
pip install mss==9.0.1

# Image processing
pip install numpy==1.24.3

# For Windows-specific window detection (optional)
# pip install pywin32==306  # Windows only

# For macOS-specific window detection (optional)
# pip install pyobjc-framework-Quartz==9.2  # macOS only

# For Linux-specific window detection (optional)
# pip install python-xlib==0.33  # Linux only
```

## System Requirements

### Tesseract OCR Installation

The screen scraper requires Tesseract OCR to be installed on your system:

#### Windows
1. Download installer from: https://github.com/UB-Mannheim/tesseract/wiki
2. Run the installer
3. Add Tesseract to your PATH or set the path in the code:
   ```python
   pytesseract.pytesseract.tesseract_cmd = r'C:\Program Files\Tesseract-OCR\tesseract.exe'
   ```

#### macOS
```bash
brew install tesseract
```

#### Linux (Ubuntu/Debian)
```bash
sudo apt-get update
sudo apt-get install tesseract-ocr
sudo apt-get install libtesseract-dev
```

#### Linux (Fedora/RHEL)
```bash
sudo dnf install tesseract
sudo dnf install tesseract-devel
```

## Quick Installation Script

Create a file `install_requirements.sh`:

```bash
#!/bin/bash

# Create virtual environment (optional but recommended)
python3 -m venv poker_env
source poker_env/bin/activate  # On Windows: poker_env\Scripts\activate

# Install Python packages
pip install --upgrade pip
pip install opencv-python==4.8.1.78
pip install opencv-contrib-python==4.8.1.78
pip install pytesseract==0.3.10
pip install Pillow==10.1.0
pip install mss==9.0.1
pip install numpy==1.24.3

# Install existing poker assistant requirements
pip install tkinter  # Usually comes with Python
pip install pytest  # For testing

echo "Installation complete!"
echo "Don't forget to install Tesseract OCR for your OS (see README)"
```

## Verification

Run this Python script to verify installation:

```python
#!/usr/bin/env python3
"""Verify screen scraper dependencies are installed correctly."""

def check_dependencies():
    """Check if all required dependencies are installed."""
    
    dependencies = []
    
    # Check OpenCV
    try:
        import cv2
        dependencies.append(("OpenCV", cv2.__version__, "✅"))
    except ImportError:
        dependencies.append(("OpenCV", "Not installed", "❌"))
    
    # Check Pytesseract
    try:
        import pytesseract
        # Try to get Tesseract version
        try:
            version = pytesseract.get_tesseract_version()
            dependencies.append(("Tesseract OCR", str(version), "✅"))
        except:
            dependencies.append(("Pytesseract", "Installed but Tesseract not found", "⚠️"))
    except ImportError:
        dependencies.append(("Pytesseract", "Not installed", "❌"))
    
    # Check PIL/Pillow
    try:
        from PIL import Image
        import PIL
        dependencies.append(("Pillow", PIL.__version__, "✅"))
    except ImportError:
        dependencies.append(("Pillow", "Not installed", "❌"))
    
    # Check mss
    try:
        import mss
        dependencies.append(("mss", mss.__version__, "✅"))
    except ImportError:
        dependencies.append(("mss", "Not installed", "❌"))
    
    # Check numpy
    try:
        import numpy as np
        dependencies.append(("NumPy", np.__version__, "✅"))
    except ImportError:
        dependencies.append(("NumPy", "Not installed", "❌"))
    
    # Print results
    print("="*50)
    print("POKER SCREEN SCRAPER - DEPENDENCY CHECK")
    print("="*50)
    
    all_ok = True
    for name, version, status in dependencies:
        print(f"{status} {name:<20} {version}")
        if status == "❌":
            all_ok = False
    
    print("="*50)
    
    if all_ok:
        print("✅ All dependencies are installed correctly!")
    else:
        print("❌ Some dependencies are missing. Please install them.")
    
    return all_ok


if __name__ == "__main__":
    check_dependencies()
```

## Docker Alternative (Optional)

For consistent environment across different systems:

```dockerfile
FROM python:3.9-slim

# Install system dependencies
RUN apt-get update && apt-get install -y \
    tesseract-ocr \
    libtesseract-dev \
    libgl1-mesa-glx \
    libglib2.0-0 \
    libsm6 \
    libxext6 \
    libxrender-dev \
    libgomp1 \
    wget \
    && rm -rf /var/lib/apt/lists/*

# Install Python packages
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# Copy poker assistant files
COPY . /app
WORKDIR /app

CMD ["python", "poker_gui_autopilot.py"]
```

## Troubleshooting

### Common Issues and Solutions

1. **Tesseract not found**
   - Ensure Tesseract is installed and in your PATH
   - Set the path explicitly in the code if needed

2. **OpenCV import error**
   - Try: `pip uninstall opencv-python opencv-contrib-python`
   - Then: `pip install opencv-python opencv-contrib-python`

3. **Screen capture not working**
   - On macOS: Grant screen recording permission to Terminal/IDE
   - On Linux: Ensure X11 is properly configured
   - On Windows: Run as administrator if needed

4. **Poor OCR accuracy**
   - Ensure poker client is at 100% zoom
   - Use a clear, high-contrast theme
   - Adjust preprocessing parameters in the code

5. **Performance issues**
   - Reduce capture frequency (increase update interval)
   - Use smaller regions of interest
   - Enable caching in the code
